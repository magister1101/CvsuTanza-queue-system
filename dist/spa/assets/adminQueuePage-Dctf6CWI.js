import{Q as w}from"./QCard-Dna_0p2Q.js";import{f,u as P,k as B,x as M,o as g,b as E,w as a,e as t,a as s,c as x,t as r,m as h,Q as d,h as O,V as G,g as b,n as H,F as Y,N as c}from"./index-BMhglyKV.js";import{Q as J,a as p}from"./QPage-DPsZlzTf.js";import{Q as K}from"./QInput-CefROznu.js";import{Q as X}from"./QForm-RWsXu0Um.js";import{Q as T}from"./QDialog-CdgP6t9L.js";import{C as Z}from"./ClosePopup-kb-HSuyh.js";import{a as y}from"./axios-upsvKRUO.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-xojyzzLc.js";import"./use-key-composition-BODgx2F7.js";import"./use-prevent-scroll-NfEf-uE_.js";import"./scroll-BbPNP22x.js";import"./use-timeout-FgPeAw9M.js";const te={class:"main-container q-pt-md"},se={class:"content-container q-px-md q-px-sm-xl"},oe={key:0,class:"text-h5 text-weight-bold text-uppercase"},le={key:0,class:"text-h5 text-weight-bold"},ne={align:"right",class:"q-mr-md"},ae={key:0,class:"text-h5 text-weight-bold"},ie={class:"q-mr-md"},re={class:"action-button-container ellipsis"},ue={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"8px"}},de={class:"action-button-container ellipsis",style:{display:"flex","flex-direction":"column","align-items":"center",gap:"12px"}},ce={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"8px"}},fe={style:{display:"flex","justify-content":"center",gap:"8px"}},ge={class:"action-button-container ellipsis"},pe={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"8px"}},ve={class:"action-button-container ellipsis"},me={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"8px"}},ye={class:"action-button-container ellipsis"},xe={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"8px"}},he={class:"action-button-container ellipsis"},be={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"8px"}},we={class:"list-container",style:{border:"2px solid #cbcdc7"}},ke={style:{"background-color":"#fefffe",height:"350px",width:"100%","text-align":"center","align-content":"center"},class:"text-h3 q-py-md text-weight-bold"},_e={class:"list-container",style:{border:"2px solid #cbcdc7"}},Qe={style:{"background-color":"#fefffe",height:"350px",width:"100%","text-align":"center","align-content":"center"},class:"text-h3 q-py-md text-weight-bold"},Se={key:0},qe={class:"list-container",style:{border:"2px solid #cbcdc7"}},Ce={style:{"background-color":"#fefffe",height:"350px",width:"100%","text-align":"center","align-content":"center"},class:"text-h3 q-py-md text-weight-bold"},Ee={key:0},Ne={class:"list-container",style:{border:"2px solid #cbcdc7"}},$e={style:{"background-color":"#fefffe",height:"350px",width:"100%","text-align":"center","align-content":"center"},class:"text-h3 q-py-md text-weight-bold"},Ie={key:0},Te={class:"dialog-content"},Ue={class:"text-subtitle1"},Re={class:"text-subtitle1"},Ae={class:"text-subtitle1"},ze={class:"text-subtitle1"},Ve={class:"text-subtitle1"},je={class:"text-subtitle1"},De={class:"text-subtitle1"},We={class:"text-subtitle1"},Le={class:"text-subtitle1"},Fe={class:"course-item"},Pe={__name:"adminQueuePage",setup(Be){f(null),f([]);const u=f(!1),Q=f(!1),S=f(""),k=f(!1),i=f(null),N=f(null),n=f(null),U=P(),$=f(null),q=f(!1),_=window.speechSynthesis;async function R(){U.push("/new/queueList")}async function v(){const l=localStorage.getItem("authToken");try{const e=await y.get("https://pre-registration-and-queueing-system-be.vercel.app/users/myProfile",{headers:{Authorization:l}});$.value=e.data._id,i.value=e.data,m(e.data.role)}catch(e){console.error(e)}}async function m(l){if(!l)return;const e=localStorage.getItem("authToken");try{const o=await y.get(`https://pre-registration-and-queueing-system-be.vercel.app/queues/current/${l}`,{headers:{Authorization:e}});n.value=o.data.currentQueue[0],N.value=o.data.currentQueue.length}catch(o){console.error(o)}}async function A(l){u.value=!0;const e=localStorage.getItem("authToken");try{const o=await y.put(`https://pre-registration-and-queueing-system-be.vercel.app/queues/next/${l}`,null,{headers:{Authorization:e}});m(i.value.role),v(),c.create({type:"positive",message:"Queue has been transferred successfully"})}catch(o){console.error(o),c.create({type:"negative",message:"Something went wrong"})}finally{u.value=!1}}async function C(l,e){u.value=!0;const o=localStorage.getItem("authToken");console.log(e);try{const I=await y.post(`https://pre-registration-and-queueing-system-be.vercel.app/queues/updateQueue/${l}`,{destination:e},{headers:{"Content-Type":"application/json",Authorization:o}});m(i.value.role),v(),c.create({type:"positive",message:"Queue has been transferred successfully"})}catch(I){console.error(I),c.create({type:"negative",message:"Something went wrong"})}finally{u.value=!1}}async function z(l){u.value=!0;const e=localStorage.getItem("authToken");try{const o=await y.post(`https://pre-registration-and-queueing-system-be.vercel.app/queues/done/${l}`,null,{headers:{Authorization:e}});m(i.value.role),v(),c.create({type:"positive",message:"Queue has been marked as done successfully"})}catch(o){console.error(o),c.create({type:"negative",message:"Something went wrong"})}finally{u.value=!1}}async function V(){u.value=!0;const l=localStorage.getItem("authToken");try{const e=await y.get("https://pre-registration-and-queueing-system-be.vercel.app/users/resetQueue",{headers:{Authorization:l}});m(i.value.role),v(),c.create({type:"positive",message:"Reset queue successfully"})}catch(e){console.error(e),c.create({type:"negative",message:"Something went wrong"})}finally{u.value=!1}}async function j(){u.value=!0;try{m(i.value.role),v(),c.create({type:"positive",message:"Refreshed successfully"})}catch(l){console.error(l),c.create({type:"negative",message:"Something went wrong"})}finally{u.value=!1}}async function D(l){u.value=!0;const e=localStorage.getItem("authToken");try{const o=await y.post(`https://pre-registration-and-queueing-system-be.vercel.app/queues/cancel/${l}`,null,{headers:{Authorization:e}});m(n.value.role),v(),c.create({type:"posotive",message:"Queue has been cancelled successfully"})}catch(o){console.error(o),c.create({type:"negative",message:"Something went wrong"})}finally{u.value=!1}}async function W(){Q.value=!0;try{const l=localStorage.getItem("authToken"),e=await y.post(`https://pre-registration-and-queueing-system-be.vercel.app/users/update/${$.value}`,{window:S.value},{headers:{Authorization:l,"Content-Type":"application/json"}});v(),c.create({type:"positive",message:"Window has been set successfully"})}catch(l){console.error(l),c.create({type:"negative",message:"Something went wrong"})}finally{Q.value=!1,k.value=!1}}const L=()=>{if(_.speaking){console.warn("Speech already in progress...");return}if(n.value&&n.value.queueNumber){const l=`${i.value.role} Window, ${i.value.window}. Now serving number ${n.value.queueNumber}`,e=new SpeechSynthesisUtterance(l);e.rate=.8,_.speak(e)}},F=()=>{_.speaking&&_.cancel()};return B(async()=>{await v();const l=setInterval(()=>{i.value?.role&&m(i.value.role)},5e3);M(()=>{clearInterval(l)})}),(l,e)=>(g(),E(J,{style:{height:"90vh"}},{default:a(()=>[t("div",te,[t("div",se,[s(p,{class:"row justify-around q-col-gutter-md",style:{color:"#3d3c3b"}},{default:a(()=>[s(w,{class:"info-box q-py-md ellipsis",style:{"background-color":"#fefffe",border:"2px solid #cbcdc7","text-align":"center",display:"flex","flex-direction":"column","justify-content":"space-around"}},{default:a(()=>[e[11]||(e[11]=t("div",{class:"text-h5 text-weight-medium"},"DEPARTMENT",-1)),i.value?(g(),x("div",oe,r(i.value.role),1)):h("",!0),e[12]||(e[12]=t("div",{style:{height:"50px"}},null,-1))]),_:1}),s(w,{class:"info-box q-py-md ellipsis",style:{"background-color":"#fefffe",border:"2px solid #cbcdc7","text-align":"center",display:"flex","flex-direction":"column","justify-content":"space-around"}},{default:a(()=>[e[13]||(e[13]=t("div",{class:"text-h5 text-weight-medium"},"WINDOW",-1)),i.value?(g(),x("div",le,r(i.value.window),1)):h("",!0),t("div",ne,[s(d,{label:"set",style:{"background-color":"#fffeb8"},onClick:e[0]||(e[0]=o=>k.value=!0)})])]),_:1}),s(T,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=o=>k.value=o),persistent:""},{default:a(()=>[s(w,{style:{width:"500px"}},{default:a(()=>[s(X,{onSubmit:O(W,["prevent"])},{default:a(()=>[s(p,{style:{"background-color":"#132a13",color:"#ffffff"}},{default:a(()=>e[14]||(e[14]=[t("div",{class:"text-h6"},"Set new Window",-1)])),_:1}),s(p,null,{default:a(()=>[t("div",null,[s(K,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=o=>S.value=o),type:"number",outlined:""},null,8,["modelValue"])])]),_:1}),s(p,{align:"right"},{default:a(()=>[G(s(d,{label:"Cancel",flat:"",style:{color:"red"}},null,512),[[Z]]),s(d,{label:"Submit",type:"submit",flat:"",style:{color:"green"},loading:Q.value},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(w,{class:"info-box q-py-md ellipsis",style:{"background-color":"#fefffe",border:"2px solid #cbcdc7","text-align":"center",display:"flex","flex-direction":"column","justify-content":"space-around"}},{default:a(()=>[e[15]||(e[15]=t("div",{class:"text-h5 text-weight-medium"},"CURRENT QUEUE",-1)),n.value?(g(),x("div",ae,r(n.value.queueNumber),1)):h("",!0),t("div",ie,[s(d,{label:"CALL",style:{"background-color":"#b7faff","margin-left":"8px"},onClick:L,icon:"record_voice_over"}),s(d,{label:"STOP",style:{"background-color":"#fe7e7f","margin-left":"8px"},onClick:F,icon:"stop"}),s(d,{label:"LIST",style:{"background-color":"#fffeb8","margin-left":"8px"},onClick:R})])]),_:1})]),_:1}),s(p,{class:"row justify-around q-col-gutter-md"},{default:a(()=>[t("div",re,[s(d,{onClick:e[3]||(e[3]=o=>q.value=!0),class:"action-button",style:{"background-color":"#b7faff"}},{default:a(()=>[t("div",ue,[s(b,{name:"wysiwyg",size:"80px"}),e[16]||(e[16]=t("div",{class:"text-h4 text-weight-medium"},"VIEW",-1))])]),_:1})]),t("div",de,[s(d,{onClick:e[4]||(e[4]=o=>A(n.value._id)),loading:u.value,class:"action-button",style:{"background-color":"#fcffc2",width:"200px"}},{default:a(()=>[t("div",ce,[s(b,{name:"sync_alt",size:"80px"}),e[17]||(e[17]=t("div",{class:"text-h4 text-weight-medium"},"TRANSFER",-1))])]),_:1},8,["loading"]),t("div",fe,[s(d,{label:"Registrar",style:{"background-color":"#b7faff"},onClick:e[5]||(e[5]=o=>C(n.value._id,"registrar"))}),s(d,{label:"OSAS",style:{"background-color":"#fffeb8"},onClick:e[6]||(e[6]=o=>C(n.value._id,"osas"))}),s(d,{label:"Cashier",style:{"background-color":"#fe7e7f"},onClick:e[7]||(e[7]=o=>C(n.value._id,"cashier"))})])]),t("div",ge,[s(d,{onClick:e[8]||(e[8]=o=>z(n.value._id)),loading:u.value,class:"action-button",style:{"background-color":"#aafeab"}},{default:a(()=>[t("div",pe,[s(b,{name:"check",size:"80px"}),e[18]||(e[18]=t("div",{class:"text-h4 text-weight-medium"},"DONE",-1))])]),_:1},8,["loading"])]),t("div",ve,[s(d,{onClick:e[9]||(e[9]=o=>D(n.value._id)),loading:u.value,class:"action-button",style:{"background-color":"#fe7e7f"}},{default:a(()=>[t("div",me,[s(b,{name:"close",size:"80px"}),e[19]||(e[19]=t("div",{class:"text-h4 text-weight-medium"},"CANCEL",-1))])]),_:1},8,["loading"])]),t("div",ye,[s(d,{loading:u.value,onClick:j,class:"action-button",style:{"background-color":"#b7d0ff"}},{default:a(()=>[t("div",xe,[s(b,{name:"refresh",size:"80px"}),e[20]||(e[20]=t("div",{class:"text-h4 text-weight-medium"},"REFRESH",-1))])]),_:1},8,["loading"])]),t("div",he,[s(d,{loading:u.value,onClick:V,class:"action-button",style:{"background-color":"#b7d0ff"}},{default:a(()=>[t("div",be,[s(b,{name:"restart_alt",size:"80px"}),e[21]||(e[21]=t("div",{class:"text-h4 text-weight-medium"},"RESET",-1))])]),_:1},8,["loading"])])]),_:1}),s(p,{class:"row justify-around q-py-md q-mt-md",style:{"background-color":"#fafedd",border:"2px solid #cbcdc7",height:"auto"}},{default:a(()=>[t("div",we,[e[22]||(e[22]=t("div",{class:"text-h6",style:{"background-color":"#132b12",color:"#ffffff",width:"100%","text-align":"center","justify-content":"center",height:"70px",display:"flex","align-items":"center"}}," # WAITING IN QUEUE ",-1)),t("div",ke,[t("div",null,r(N.value),1)])]),t("div",_e,[e[23]||(e[23]=t("div",{class:"text-h6",style:{"background-color":"#132b12",color:"#ffffff",width:"100%","text-align":"center","justify-content":"center",height:"70px",display:"flex","align-items":"center"}}," # TRANSFERRED QUEUE ",-1)),t("div",Qe,[i.value?(g(),x("div",Se,r(i.value.transferredQueue),1)):h("",!0)])]),t("div",qe,[e[24]||(e[24]=t("div",{class:"text-h6",style:{"background-color":"#132b12",color:"#ffffff",width:"100%","text-align":"center","justify-content":"center",height:"70px",display:"flex","align-items":"center"}}," # SUCCESSFUL QUEUE ",-1)),t("div",Ce,[i.value?(g(),x("div",Ee,r(i.value.successfulQueue),1)):h("",!0)])]),t("div",Ne,[e[25]||(e[25]=t("div",{class:"text-h6",style:{"background-color":"#132b12",color:"#ffffff",width:"100%","text-align":"center","justify-content":"center",height:"70px",display:"flex","align-items":"center"}}," # MISSED QUEUE ",-1)),t("div",$e,[i.value?(g(),x("div",Ie,r(i.value.missedQueue),1)):h("",!0)])])]),_:1}),s(T,{modelValue:q.value,"onUpdate:modelValue":e[10]||(e[10]=o=>q.value=o)},{default:a(()=>[s(w,{class:"dialog-card"},{default:a(()=>[n.value?(g(),E(p,{key:0},{default:a(()=>[e[28]||(e[28]=t("div",{class:"dialog-header"},"Queue Details",-1)),t("div",Te,[s(p,{class:"student-details"},{default:a(()=>[e[26]||(e[26]=t("div",{class:"section-title"},"Student Details:",-1)),t("div",Ue,"Username: "+r(n.value.student.username),1),t("div",Re,"Student Number: "+r(n.value.studentNumber),1),t("div",Ae,"First Name: "+r(n.value.student.firstName),1),t("div",ze," Middle Name: "+r(n.value.student.middleName),1),t("div",Ve,"Last Name: "+r(n.value.student.lastName),1),t("div",je,"Email: "+r(n.value.student.email),1),t("div",De,"Regular: "+r(n.value.student.isRegular),1),t("div",We,"Year: "+r(n.value.student.year),1),t("div",Le,"Section: "+r(n.value.student.section),1)]),_:1}),(g(!0),x(Y,null,H(n.value.courseToTake,o=>(g(),E(p,{class:"courses-section",key:o},{default:a(()=>[e[27]||(e[27]=t("div",{class:"section-title"},"Courses to Take:",-1)),t("div",Fe,[t("div",null,r(o.course)+" ("+r(o.code)+") - "+r(o.unit)+" Units",1)])]),_:2},1024))),128))])]),_:1})):h("",!0)]),_:1})]),_:1},8,["modelValue"])])])]),_:1}))}},nt=ee(Pe,[["__scopeId","data-v-4d414a79"]]);export{nt as default};
