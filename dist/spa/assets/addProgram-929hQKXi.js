import{Q as ee,a as m}from"./QPage-DPsZlzTf.js";import{f as s,k as te,r as z,o as u,b as E,w as a,N as w,e as o,a as t,i as c,c as p,Q as i,m as N,h as B,n as ae,F as q,g as F,t as j}from"./index-BMhglyKV.js";import{Q as _}from"./QInput-CefROznu.js";import{Q}from"./QCardActions-BouhufK_.js";import{Q as M}from"./QForm-RWsXu0Um.js";import{Q as A}from"./QCard-Dna_0p2Q.js";import{Q as $}from"./QDialog-CdgP6t9L.js";import{Q as W}from"./QTooltip-DY0LP1Dx.js";import{Q as oe,a as le}from"./QTable-82CfmyBW.js";import{Q as re}from"./QTr-DrqNJx8U.js";import{a as P}from"./axios-upsvKRUO.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-key-composition-BODgx2F7.js";import"./use-dark-xojyzzLc.js";import"./use-prevent-scroll-NfEf-uE_.js";import"./scroll-BbPNP22x.js";import"./use-timeout-FgPeAw9M.js";import"./QSelect-BXUjDScj.js";import"./format-DKTbQgkX.js";import"./QList-Q1GbiNYp.js";const ne={class:"main-container"},ie={class:"content-container q-px-md q-px-sm-xl"},de={key:0,class:"button-container"},ue={class:"q-pa-md"},me={class:"row q-col-gutter-md"},ce={class:"col-12"},pe={class:"input-field"},ge={class:"row q-col-gutter-md"},fe={class:"col-12 col-sm-4"},ve={class:"input-field"},ye={class:"q-mt-lg"},be={key:0,class:"row q-gutter-x-sm"},xe={class:"q-pa-md"},we={class:"row q-col-gutter-md"},_e={class:"col-12"},Pe={class:"input-field"},ke={class:"row q-col-gutter-md"},he={class:"col-12 col-sm-4"},qe={class:"input-field"},Ve={__name:"addProgram",setup(Ce){const n=s(!1),g=s(!1),f=s(!1),v=s(!1),y=s(""),b=s(""),V=s(""),I=s([{name:"#",required:!0,label:"#",align:"center",field:"index",sortable:!0},{name:"program",required:!0,label:"Program Code",align:"left",field:"program",sortable:!0},{name:"programTitle",align:"left",label:"Program Title",field:"programTitle",sortable:!0},{name:"action",align:"center",label:"Action",field:"action"}]),S=s([]),d=s({programTitle:"",program:"",action:""}),U=s(""),C=s(""),L=s(""),D=s(null);function G(r){D.value=r,v.value=!0}async function H(){await R(D.value),v.value=!1}async function J(){n.value=!0;try{const r=localStorage.getItem("authToken");await P.post("https://pre-registration-and-queueing-system-be.vercel.app/courses/createProgram",{code:b.value,name:y.value},{headers:{Authorization:r,"Content-Type":"application/json"}}),w.create({type:"positive",message:"Program added successfully!"}),y.value="",b.value="",k()}catch(r){console.error(r)}finally{n.value=!1,f.value=!1}}async function k(){try{const r=localStorage.getItem("authToken"),e=await P.get("https://pre-registration-and-queueing-system-be.vercel.app/courses/getProgram?isArchived=false",{headers:{Authorization:r}});S.value=e.data.map((x,T)=>({index:T+1,program:x.code,programTitle:x.name,action:x._id}))}catch(r){console.error("Error fetching programs:",r)}}function K(r){d.value={programTitle:r.programTitle,program:r.program,action:r.action},g.value=!0}async function O(r){n.value=!0;try{const e=localStorage.getItem("authToken");await P.post(`https://pre-registration-and-queueing-system-be.vercel.app/courses/updateProgram/${r}`,{code:d.value.program,name:d.value.programTitle},{headers:{Authorization:e,"Content-Type":"application/json"}}),w.create({type:"positive",message:"Program edited"}),g.value=!1}catch(e){console.error(e)}finally{k(),n.value=!1}}async function R(r){n.value=!0;try{const e=localStorage.getItem("authToken");await P.post(`https://pre-registration-and-queueing-system-be.vercel.app/courses/updateProgram/${r}`,{isArchived:!0},{headers:{Authorization:e,"Content-Type":"application/json"}}),w.create({type:"positive",message:"Program deleted"})}catch(e){console.error(e),w.create({type:"negative",message:"Something Went Wrong"})}finally{k(),n.value=!1}}async function X(){y.value="",b.value="",f.value=!1}async function Y(){const r=localStorage.getItem("authToken");try{const e=await P.get("https://pre-registration-and-queueing-system-be.vercel.app/users/myProfile",{headers:{Authorization:r}});return U.value=e.data.role,U.value==="admin"?C.value=!0:L.value=!0}catch(e){console.error(e),w.create({type:"negative",message:"Error fetching user information"})}}return te(()=>{Y(),k()}),(r,e)=>{const x=z("q-card-title"),T=z("q-card-main");return u(),E(ee,{style:{height:"90vh"}},{default:a(()=>[o("div",ne,[o("div",ie,[t(m,{class:"q-pt-md"},{default:a(()=>e[12]||(e[12]=[o("div",{class:"text-h6 text-weight-medium",style:{color:"#282726"}},[c(" Admin/"),o("span",{style:{color:"#b1b2b4"}},"Program")],-1)])),_:1}),C.value?(u(),p("div",de,[t(m,{class:"button-section"},{default:a(()=>[t(i,{label:"Add Program","no-caps":"",flat:"",class:"action-button",onClick:e[0]||(e[0]=l=>f.value=!0)})]),_:1})])):N("",!0),o("div",null,[t($,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value=l),persistent:""},{default:a(()=>[t(A,{style:{width:"800px","max-width":"95vw"}},{default:a(()=>[t(M,{onSubmit:B(J,["prevent"])},{default:a(()=>[o("div",ue,[t(m,{class:"text-h6 text-weight-medium",style:{color:"#282726"}},{default:a(()=>e[13]||(e[13]=[c(" Add Program ")])),_:1}),t(m,null,{default:a(()=>[o("div",me,[o("div",ce,[e[14]||(e[14]=o("div",{class:"text-subtitle2 q-mb-sm"},"Program Title",-1)),o("div",pe,[t(_,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=l=>y.value=l),type:"text",borderless:""},null,8,["modelValue"])])])]),o("div",ge,[o("div",fe,[e[15]||(e[15]=o("div",{class:"text-subtitle2 q-mb-sm"},"Program Code",-1)),o("div",ve,[t(_,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),type:"text",borderless:""},null,8,["modelValue"])])])])]),_:1}),t(Q,{align:"right"},{default:a(()=>[t(i,{flat:"",label:"Close",onClick:X,color:"red-8",class:"q-px-md"}),t(i,{loading:n.value,type:"submit",flat:"",label:"Add",class:"q-px-md",style:{"background-color":"#306b30",color:"#ffffff",width:"100px"}},null,8,["loading"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o("div",ye,[t(oe,{style:{"border-radius":"14px","background-color":"#fdffdf"},title:"Program Information",rows:S.value,columns:I.value,"row-key":"id",separator:"cell",filter:V.value,"rows-per-page-options":[0,5,10,15,20],class:"responsive-table"},{body:a(l=>[t(re,{props:l},{default:a(()=>[(u(!0),p(q,null,ae(I.value,h=>(u(),E(le,{key:h.name,props:l},{default:a(()=>[h.name==="#"?(u(),p(q,{key:0},[c(j(l.rowIndex+1),1)],64)):h.name==="action"?(u(),p(q,{key:1},[C.value?(u(),p("div",be,[t(i,{flat:"",dense:"",size:"sm",icon:"edit",color:"primary",onClick:Z=>K(l.row)},{default:a(()=>[t(W,null,{default:a(()=>e[16]||(e[16]=[c("Edit")])),_:1})]),_:2},1032,["onClick"]),t(i,{flat:"",dense:"",size:"sm",loading:n.value,icon:"delete",color:"negative",onClick:Z=>G(l.row.action)},{default:a(()=>[t(W,null,{default:a(()=>e[17]||(e[17]=[c("Delete")])),_:1})]),_:2},1032,["loading","onClick"])])):N("",!0)],64)):(u(),p(q,{key:2},[c(j(l.row[h.name]),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-left":a(()=>[t(_,{borderless:"",dense:"",debounce:"300",modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=l=>V.value=l),placeholder:"Search"},{append:a(()=>[t(F,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter"])]),o("div",null,[t($,{modelValue:g.value,"onUpdate:modelValue":e[9]||(e[9]=l=>g.value=l),persistent:""},{default:a(()=>[t(A,{style:{width:"800px","max-width":"95vw"}},{default:a(()=>[t(M,{onSubmit:e[8]||(e[8]=B(l=>O(d.value.action),["prevent"]))},{default:a(()=>[o("div",xe,[t(m,{class:"text-h6 text-weight-medium",style:{color:"#282726"}},{default:a(()=>e[18]||(e[18]=[c(" Edit Program ")])),_:1}),t(m,null,{default:a(()=>[o("div",we,[o("div",_e,[e[19]||(e[19]=o("div",{class:"text-subtitle2 q-mb-sm"},"Program Title",-1)),o("div",Pe,[t(_,{modelValue:d.value.programTitle,"onUpdate:modelValue":e[5]||(e[5]=l=>d.value.programTitle=l),type:"text",borderless:""},null,8,["modelValue"])])])]),o("div",ke,[o("div",he,[e[20]||(e[20]=o("div",{class:"text-subtitle2 q-mb-sm"},"Program Code",-1)),o("div",qe,[t(_,{modelValue:d.value.program,"onUpdate:modelValue":e[6]||(e[6]=l=>d.value.program=l),type:"text",borderless:""},null,8,["modelValue"])])])])]),_:1}),t(Q,{align:"right"},{default:a(()=>[t(i,{flat:"",label:"Cancel",onClick:e[7]||(e[7]=l=>g.value=!1),color:"red-8",class:"q-px-md"}),t(i,{loading:n.value,type:"submit",flat:"",label:"Save",class:"q-px-md",style:{"background-color":"#306b30",color:"#ffffff",width:"100px"}},null,8,["loading"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t($,{modelValue:v.value,"onUpdate:modelValue":e[11]||(e[11]=l=>v.value=l),persistent:""},{default:a(()=>[t(A,null,{default:a(()=>[t(m,null,{default:a(()=>[t(x,{class:"row items-center"},{default:a(()=>[t(F,{name:"warning",color:"negative",class:"q-mr-sm"}),e[21]||(e[21]=o("span",{class:"text-h6"},"Delete Program?",-1))]),_:1}),t(T,null,{default:a(()=>e[22]||(e[22]=[o("div",{class:"text-subtitle1"},"Are you sure you want to delete this program?",-1)])),_:1}),t(Q,{align:"right"},{default:a(()=>[t(i,{flat:"",label:"Cancel",color:"red-8",onClick:e[10]||(e[10]=l=>v.value=!1),class:"q-px-md"}),t(i,{flat:"",label:"Delete",color:"negative",loading:n.value,onClick:H,class:"q-px-md"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}}},Ke=se(Ve,[["__scopeId","data-v-3b51ca4c"]]);export{Ke as default};
