import{Q as A,a as i}from"./QPage-DPsZlzTf.js";import{Q as C,a as z}from"./QTable-82CfmyBW.js";import{Q as B}from"./QTr-DrqNJx8U.js";import{Q as E}from"./QTooltip-DY0LP1Dx.js";import{u as L,f as r,k as F,o as c,b as S,w as s,N as m,e as a,a as o,t as l,c as g,n as U,F as p,Q as V,i as f}from"./index-BMhglyKV.js";import{a as u}from"./axios-upsvKRUO.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-xojyzzLc.js";import"./QList-Q1GbiNYp.js";import"./QSelect-BXUjDScj.js";import"./use-key-composition-BODgx2F7.js";import"./format-DKTbQgkX.js";import"./use-prevent-scroll-NfEf-uE_.js";import"./scroll-BbPNP22x.js";import"./QDialog-CdgP6t9L.js";import"./use-timeout-FgPeAw9M.js";const j={class:"main-container"},D={class:"content-container q-px-md q-px-sm-xl"},H={class:"text-h4 text-weight-medium",style:{color:"#282726"}},M={class:"stats-container"},W={class:"stat-card"},G={class:"text-h4 text-weight-bold"},J={class:"stat-card"},K={class:"text-h4 text-weight-bold"},O={class:"stat-card"},X={class:"text-h4 text-weight-bold"},Z={class:"stat-card"},ee={class:"text-h4 text-weight-bold"},te={class:"q-mt-lg"},ae={__name:"dashboardPage",setup(se){const Q=L(),h=r(),v=r(""),_=r(0),b=r(0),y=r(0),x=r(0),k=r([{name:"#",required:!0,label:"#",align:"center",field:(t,e)=>e+1,sortable:!0},{name:"studentId",required:!0,label:"Student Number",align:"left",field:t=>t.studentId,sortable:!0},{name:"name",align:"left",label:"Student Name",field:"name"},{name:"email",align:"left",label:"Email",field:"email"},{name:"username",align:"left",label:"Username",field:"username"},{name:"program",align:"left",label:"Program",field:"program",sortable:!0},{name:"year",align:"left",label:"Year",field:"year",sortable:!0},{name:"section",align:"left",label:"Section",field:"section",sortable:!0},{name:"courses",align:"left",label:"Course Taken",field:"courses"},{name:"status",align:"left",label:"Status",field:"status",sortable:!0}]),w=r([]),q=()=>{localStorage.clear()};async function N(){try{const t=await u.get("https://pre-registration-and-queueing-system-be.vercel.app/users?role=student&&isArchived=false");w.value=t.data.map(e=>({studentId:e.studentNumber,name:`${e.firstName} ${e.middleName?e.middleName+" ":""}${e.lastName}`.trim(),username:e.username,email:e.email,program:e.course,year:e.year,section:e.section,courses:e.courses?.map(n=>n.code).join(", "),status:e.isRegular?"Regular":"Irregular"})),_.value=t.data.length}catch(t){console.error("Error fetching users:",t)}}async function T(){const t=localStorage.getItem("authToken");try{const e=await u.get("https://pre-registration-and-queueing-system-be.vercel.app/users/myProfile",{headers:{Authorization:t}});v.value=e.data.firstName,h.value=e.data.role,h.value==="student"&&(m.create({type:"warning",message:"You are not authorized to access this page"}),Q.replace("/"),q());return}catch(e){console.error(e)}}async function I(){try{const t=localStorage.getItem("authToken"),e=await u.get("https://pre-registration-and-queueing-system-be.vercel.app/courses/getProgram?isArchived=false",{headers:{Authorization:t}});b.value=e.data.length}catch(t){console.error(t)}}async function P(){try{const t=localStorage.getItem("authToken"),e=await u.get("https://pre-registration-and-queueing-system-be.vercel.app/courses?isArchived=false",{headers:{Authorization:t}});y.value=e.data.length}catch(t){console.error("Error fetching programs:",t)}}async function R(){const t=localStorage.getItem("authToken");try{const e=await u.get("https://pre-registration-and-queueing-system-be.vercel.app/queues?query=Waiting",{headers:{Authorization:t}});x.value=e.data.length}catch(e){console.error(e)}}async function $(){const t="https://queuing-nu.vercel.app/#/studentRegister";try{await navigator.clipboard.writeText(t),m.create({type:"positive",message:"Registration link copied to clipboard!",position:"top"})}catch(e){console.error("Failed to copy:",e),m.create({type:"negative",message:"Failed to copy link",position:"top"})}}return F(()=>{N(),T(),I(),P(),R()}),(t,e)=>(c(),S(A,{style:{height:"90vh"}},{default:s(()=>[a("div",j,[a("div",D,[o(i,{class:"q-pt-md"},{default:s(()=>[a("div",H,"Hi, "+l(v.value),1)]),_:1}),a("div",M,[a("div",W,[o(i,null,{default:s(()=>[a("div",G,l(_.value),1),e[0]||(e[0]=a("div",{class:"text-h6"},"Enrolled Students",-1))]),_:1})]),a("div",J,[o(i,null,{default:s(()=>[a("div",K,l(y.value),1),e[1]||(e[1]=a("div",{class:"text-h6"},"Total Courses",-1))]),_:1})]),a("div",O,[o(i,null,{default:s(()=>[a("div",X,l(b.value),1),e[2]||(e[2]=a("div",{class:"text-h6"},"Total Programs",-1))]),_:1})]),a("div",Z,[o(i,null,{default:s(()=>[a("div",ee,l(x.value),1),e[3]||(e[3]=a("div",{class:"text-h6"},"Total Queue",-1))]),_:1})])]),a("div",te,[o(C,{style:{"border-radius":"14px","background-color":"#fdffdf"},title:"Recent Students",rows:w.value,columns:k.value,"row-key":"studentId",separator:"cell","rows-per-page-options":[0,15,20,25,30],class:"responsive-table"},{body:s(n=>[o(B,{props:n},{default:s(()=>[(c(!0),g(p,null,U(k.value,d=>(c(),S(z,{key:d.name,props:n},{default:s(()=>[d.name==="#"?(c(),g(p,{key:0},[f(l(n.rowIndex+1),1)],64)):(c(),g(p,{key:1},[f(l(n.row[d.name]),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"top-left":s(()=>[o(V,{label:"Signup Link",onClick:$,"no-caps":""},{default:s(()=>[o(E,null,{default:s(()=>e[4]||(e[4]=[f(" Registration Link for student ")])),_:1})]),_:1})]),_:1},8,["rows","columns"])])])])]),_:1}))}},ye=Y(ae,[["__scopeId","data-v-e37fba80"]]);export{ye as default};
