import{Q as $,a as f}from"./QPage-DPsZlzTf.js";import{Q as B,b as k,c as x,a as i}from"./QTable-82CfmyBW.js";import{Q}from"./QTr-DrqNJx8U.js";import{p as F,u as j,f as l,l as z,k as P,o as y,b as C,w as s,N as g,e as r,a as t,h as L,c as M,n as R,F as D,g as E,i as d,t as c,Q as O}from"./index-BMhglyKV.js";import{Q as Y}from"./QInput-CefROznu.js";import{Q as G}from"./QSpace-n_TQuSIW.js";import{Q as H}from"./QForm-RWsXu0Um.js";import{a as _}from"./axios-upsvKRUO.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-xojyzzLc.js";import"./QList-Q1GbiNYp.js";import"./QSelect-BXUjDScj.js";import"./use-key-composition-BODgx2F7.js";import"./format-DKTbQgkX.js";import"./use-prevent-scroll-NfEf-uE_.js";import"./scroll-BbPNP22x.js";import"./QDialog-CdgP6t9L.js";import"./use-timeout-FgPeAw9M.js";const K={style:{background:`url('https://res.cloudinary.com/dqaw6ndtn/image/upload/v1737617278/assets/queing/q5xrh22iplhm2bndvvru.jpg')
            no-repeat center center`,"background-size":"cover",width:"100%",height:"100vh",border:"3px solid #606060"}},W={style:{width:"80%"}},X={style:{display:"flex",width:"100%"},class:"q-mt-md"},Z={class:"q-ml-md"},ee={__name:"registerCourse",setup(te){const V=F(),q=j(),m=l(!1),b=V.params.userId,p=l([]),v=l(!1),w=l([]),h=l(""),n=l([]),I=l([{name:"code",label:"Course Code",align:"left",field:"code"},{name:"name",label:"Course Name",align:"left",field:"name"},{name:"unit",label:"Units",align:"left",field:"unit"},{name:"course",label:"Program",align:"left",field:"course"},{name:"prerequisite",label:"Prerequisite",align:"left",field:"prerequisite"}]);async function S(){m.value=!0;try{const e=(await _.get(`https://pre-registration-and-queueing-system-be.vercel.app/users?query=${b}`)).data[0].course;console.log(e),T(e)}catch(a){console.error(a)}finally{m.value=!1}}async function T(a){m.value=!0;try{const o=localStorage.getItem("Authtoken"),e=await _.get(`https://pre-registration-and-queueing-system-be.vercel.app/courses?isArchived=false&program=${a}`,{headers:{"Content-Type":"application/json",authorization:o}});e.data&&Array.isArray(e.data)?n.value=e.data:(console.error("Invalid response format:",e),n.value=[],g.create({type:"negative",message:"Invalid data format received from server"}))}catch(o){console.error(o),n.value=[],g.create({type:"negative",message:"Failed to fetch students data"})}finally{m.value=!1}}async function A(){try{const a=localStorage.getItem("Authtoken"),o=await _.post(`https://pre-registration-and-queueing-system-be.vercel.app/users/update/${b}`,{courses:w.value},{headers:{"Content-Type":"application/json",authorization:a}});g.create({type:"positive",message:"Courses updated successfully"}),q.replace("/thankYou")}catch(a){console.error(a),g.create({type:"negative",message:"Failed to update courses"})}}const N=a=>{p.value=a?[...n.value]:[]};z(p,a=>{w.value=a.map(o=>o._id),v.value=a.length===n.value.length});const U=a=>a?Array.isArray(a)?a.map(o=>o.code).join(", "):a.code||"None":"None";return P(()=>{S()}),(a,o)=>(y(),C($,null,{default:s(()=>[r("div",null,[r("div",K,[t(f,{class:"flex flex-center"},{default:s(()=>[r("div",W,[t(f,{class:"text-center",style:{"margin-top":"40px"}},{default:s(()=>o[3]||(o[3]=[r("div",{class:"text-h4 text-weight-bold text-uppercase"},"Course Taken",-1)])),_:1}),t(f,{class:"container-courseInfo"},{default:s(()=>[t(H,{onSubmit:L(A,["prevent"])},{default:s(()=>[t(B,{class:"courseTable",rows:n.value,loading:m.value,columns:I.value,filter:h.value,separator:"cell","row-key":"_id",selection:"multiple",selected:p.value,"onUpdate:selected":o[2]||(o[2]=e=>p.value=e)},{header:s(e=>[t(Q,{props:e},{default:s(()=>[t(k,{"auto-width":""},{default:s(()=>[t(x,{modelValue:v.value,"onUpdate:modelValue":[o[0]||(o[0]=u=>v.value=u),N]},null,8,["modelValue"])]),_:1}),(y(!0),M(D,null,R(e.cols,u=>(y(),C(k,{key:u.name},{default:s(()=>[d(c(u.label),1)]),_:2},1024))),128))]),_:2},1032,["props"])]),"top-left":s(()=>[t(Y,{borderless:"",dense:"",debounce:"300",modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=e=>h.value=e),placeholder:"Search"},{append:s(()=>[t(E,{name:"search"})]),_:1},8,["modelValue"])]),body:s(e=>[t(Q,{props:e},{default:s(()=>[t(i,{"auto-width":""},{default:s(()=>[t(x,{modelValue:e.selected,"onUpdate:modelValue":u=>e.selected=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,null,{default:s(()=>[d(c(e.row.code),1)]),_:2},1024),t(i,null,{default:s(()=>[d(c(e.row.name),1)]),_:2},1024),t(i,null,{default:s(()=>[d(c(e.row.unit),1)]),_:2},1024),t(i,null,{default:s(()=>[d(c(e.row.course),1)]),_:2},1024),t(i,null,{default:s(()=>[d(c(U(e.row.prerequisite)),1)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","loading","columns","filter","selected"]),r("div",X,[t(G),r("div",Z,[t(O,{loading:a.loading,type:"submit",icon:"arrow_forward",size:"24px",style:{width:"100px",height:"100px",color:"#ffffff","background-color":"#31562d","border-radius":"50%"}},null,8,["loading"])])])]),_:1}),t(f,null,{default:s(()=>o[4]||(o[4]=[r("div",null,"Take Note, Only Select the Courses that you have taken.",-1)])),_:1})]),_:1})])]),_:1})])])]),_:1}))}},be=J(ee,[["__scopeId","data-v-8435fcfa"]]);export{be as default};
