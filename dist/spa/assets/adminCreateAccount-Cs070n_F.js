import{Q as ae,a as r}from"./QPage-DPsZlzTf.js";import{Q as se,a as re,b as de}from"./QBtnDropdown-CaziSX2m.js";import{Q as ue,a as U}from"./QTable-82CfmyBW.js";import{f as d,k as ne,o as F,b as ie,w as a,N as c,e as t,a as l,i as u,a8 as fe,Q as b,t as Q,c as me,m as pe,g as ve,V as R,h as M}from"./index-BMhglyKV.js";import{Q as ce}from"./QList-Q1GbiNYp.js";import{Q as ge}from"./QTr-DrqNJx8U.js";import{Q as n}from"./QInput-CefROznu.js";import{Q as I}from"./QCard-Dna_0p2Q.js";import{Q as j}from"./QDialog-CdgP6t9L.js";import{Q as D}from"./QSelect-BXUjDScj.js";import{Q as O}from"./QForm-RWsXu0Um.js";import{C as Y}from"./ClosePopup-kb-HSuyh.js";import{a as _}from"./axios-upsvKRUO.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-xojyzzLc.js";import"./use-key-composition-BODgx2F7.js";import"./scroll-BbPNP22x.js";import"./use-prevent-scroll-NfEf-uE_.js";import"./use-timeout-FgPeAw9M.js";import"./format-DKTbQgkX.js";const ye={class:"main-container"},xe={class:"content-container q-px-md q-px-sm-xl"},we={class:"q-mt-lg"},Ve={key:0,class:"row q-gutter-x-sm"},_e={align:"right"},ke={class:"q-px-md",style:{display:"flex","flex-direction":"column",width:"100%","max-width":"1200px","background-color":"#fbfedf","border-radius":"14px"}},he={class:"row justify-center q-col-gutter-md"},Ue={class:"col-12 col-sm-4"},qe={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Ne={class:"col-12 col-sm-4"},Ce={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Qe={class:"col-12 col-sm-4"},De={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Se={class:"row justify-center q-col-gutter-md"},Ae={class:"col-12 col-sm-6"},Ee={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Te={class:"col-12 col-sm-6"},$e={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Ie={class:"row justify-center q-col-gutter-md"},je={class:"col-12 col-sm-6"},Pe={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Le={class:"col-12 col-sm-6"},ze={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Be={class:"row justify-center q-col-gutter-md"},Fe={class:"col-12 col-sm-6"},Re={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Me={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},Oe={class:"q-px-md",style:{display:"flex","flex-direction":"column",width:"100%","max-width":"1200px","background-color":"#fbfedf","border-radius":"14px"}},Ye={class:"row justify-center q-col-gutter-md"},We={class:"col-12 col-sm-4"},Ge={style:{border:"2px solid #9fa092","background-color":"#fefeff","border-radius":"14px"}},He={class:"col-12 col-sm-4"},Je={style:{border:"2px solid #9fa092","background-color":"#fefeff","border-radius":"14px"}},Ke={class:"col-12 col-sm-4"},Xe={style:{border:"2px solid #9fa092","background-color":"#fefeff","border-radius":"14px"}},Ze={class:"row justify-center q-col-gutter-md"},el={class:"col-12 col-sm-6"},ll={style:{border:"2px solid #9fa092","background-color":"#fefeff","border-radius":"14px"}},tl={class:"col-12 col-sm-6"},ol={style:{border:"2px solid #9fa092","background-color":"#fefeff","border-radius":"14px"}},al={class:"row justify-center q-col-gutter-md"},sl={class:"col-12 col-sm-6"},rl={style:{border:"2px solid #9fa092","background-color":"#fefeff","border-radius":"14px"}},dl={style:{border:"2px solid #9fa092",width:"100%","background-color":"#fefeff","border-radius":"14px"}},ul={__name:"adminCreateAccount",setup(nl){const k=d(!1),w=d(!1),S=d(!1),A=d(!1),h=d(!1),q=d(null),N=d(!1),i=d(""),g=d(""),f=d(""),m=d(""),p=d(""),x=d(""),V=d(""),v=d(null),y=d(null),P=d(""),E=d(""),W=d(""),T=d({}),L=["First","Second","Third","Fourth"],G=["registrar","osas","cashier","admin"],$=d(""),z=d([]),H=d([{name:"username",required:!0,label:"Username",field:"username",align:"left"},{name:"role",required:!0,label:"Role",field:"role",align:"left",sortable:!0},{name:"name",required:!0,label:"Name",field:"name",align:"left"},{name:"email",required:!0,label:"Email",field:"email",align:"left"},{name:"action",required:!0,label:"Action",field:"action",align:"left"}]);async function J(){try{const s=localStorage.getItem("authToken"),e=await _.get("https://pre-registration-and-queueing-system-be.vercel.app/courses/getProgram?isArchived=false",{headers:{Authorization:s}});T.value={option:[...e.data.map(o=>o.name),...G]}}catch(s){console.error(s)}}async function B(){i.value="",g.value="",f.value="",m.value="",p.value="",x.value="",V.value="",v.value=null,y.value=null,k.value=!1,h.value=!1}async function K(){w.value=!0;const s=localStorage.getItem("authToken");try{if(!i.value||!f.value||!m.value||!p.value||!x.value||!V.value||!v.value){c.create({type:"warning",message:"Fill all the required fields"});return}if(x.value!==V.value){c.create({type:"negative",message:"Passwords do not match"});return}const e=await _.post("https://pre-registration-and-queueing-system-be.vercel.app/users/create",{firstName:i.value,middleName:g.value,lastName:f.value,username:m.value,email:p.value,password:x.value,role:v.value,isEmailSent:!0,year:y.value},{headers:{"Content-Type":"application/json",authorization:s}});C(),c.create({type:"positive",message:"Account Created Successfully"}),i.value="",g.value="",f.value="",m.value="",p.value="",x.value="",V.value="",v.value=null,y.value=null,k.value=!1}catch(e){console.error(e),c.create({type:"negative",message:"Error creating account"})}finally{w.value=!1}}async function C(){A.value=!0;try{const s=await _.get("https://pre-registration-and-queueing-system-be.vercel.app/users?isArchived=false");z.value=s.data.filter(e=>e.role!=="student").map(e=>({id:e._id,username:e.username,role:e.role,name:`${e.firstName} ${e.middleName||""} ${e.lastName}`.trim(),email:e.email,fullData:e}))}catch(s){console.error(s),c.create({type:"negative",message:"Error fetching users"})}finally{A.value=!1}}function X(s){q.value=s.fullData,i.value=s.fullData.firstName,g.value=s.fullData.middleName||"",f.value=s.fullData.lastName,m.value=s.fullData.username,p.value=s.fullData.email,v.value=s.fullData.role,h.value=!0,y.value=s.fullData.year}async function Z(s){q.value=s,N.value=!0}async function ee(){S.value=!0;try{const s=localStorage.getItem("authToken"),e=await _.post(`https://pre-registration-and-queueing-system-be.vercel.app/users/update/${q.value}`,{isArchived:!0},{headers:{"Content-Type":"application/json",authorization:s}});c.create({type:"positive",message:"User deleted successfully"}),C()}catch(s){console.error(s),c.create({type:"negative",message:"Error deleting user"})}finally{N.value=!1,S.value=!1}}async function le(){w.value=!0;const s=localStorage.getItem("authToken");try{const e=await _.post(`https://pre-registration-and-queueing-system-be.vercel.app/users/update/${q.value._id}`,{firstName:i.value,middleName:g.value,lastName:f.value,username:m.value,email:p.value,role:v.value},{headers:{"Content-Type":"application/json",authorization:s}});c.create({type:"positive",message:"User Updated Successfully"}),h.value=!1,C()}catch(e){console.error(e),c.create({type:"negative",message:"Error updating user"})}finally{w.value=!1}}async function te(){const s=localStorage.getItem("authToken");try{const e=await _.get("https://pre-registration-and-queueing-system-be.vercel.app/users/myProfile",{headers:{Authorization:s}});return P.value=e.data.role,P.value==="admin"?E.value=!0:W.value=!0}catch(e){console.error(e),c.create({type:"negative",message:"Error fetching user information"})}}return ne(()=>{te(),C(),J()}),(s,e)=>(F(),ie(ae,{style:{height:"90vh"}},{default:a(()=>[t("div",ye,[t("div",xe,[l(r,{class:"q-pt-md"},{default:a(()=>[e[23]||(e[23]=t("div",{class:"text-h6 text-weight-medium",style:{color:"#282726"}},[u(" Admin/"),t("span",{style:{color:"#b1b2b4"}},"Users")],-1)),l(r,{class:"q-px-none"},{default:a(()=>[l(r,{style:{"background-color":"#30582d"},class:""},{default:a(()=>e[21]||(e[21]=[t("div",{style:{color:"#ffffff"},class:"text-h6 text-weight-medium"},"User List",-1)])),_:1}),t("div",we,[l(ue,{loading:A.value,style:{"border-radius":"14px","background-color":"#fdffdf"},title:"Recent Students",rows:z.value,columns:H.value,"row-key":"id",separator:"cell",filter:$.value},fe({loading:a(()=>[l(se,{showing:"",color:"primary"},{default:a(()=>[l(re,{size:"50px"})]),_:1})]),body:a(o=>[l(ge,{props:o},{default:a(()=>[l(U,null,{default:a(()=>[u(Q(o.row.username),1)]),_:2},1024),l(U,null,{default:a(()=>[u(Q(o.row.role),1)]),_:2},1024),l(U,null,{default:a(()=>[u(Q(o.row.name),1)]),_:2},1024),l(U,null,{default:a(()=>[u(Q(o.row.email),1)]),_:2},1024),l(U,null,{default:a(()=>[E.value?(F(),me("div",Ve,[l(de,{flat:"","dropdown-icon":"more_vert"},{default:a(()=>[l(ce,null,{default:a(()=>[t("div",null,[l(b,{label:"Edit","no-caps":"",flat:"",style:{width:"100%"},color:"primary",onClick:oe=>X(o.row)},null,8,["onClick"])]),t("div",null,[l(b,{label:"Delete","no-caps":"",flat:"",style:{width:"100%",color:"red"},onClick:oe=>Z(o.row.id)},null,8,["onClick"])]),e[22]||(e[22]=t("div",null,null,-1))]),_:2},1024)]),_:2},1024)])):pe("",!0)]),_:2},1024)]),_:2},1032,["props"])]),"top-left":a(()=>[l(n,{borderless:"",dense:"",debounce:"300",modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=o=>$.value=o),placeholder:"Search"},{append:a(()=>[l(ve,{name:"search"})]),_:1},8,["modelValue"])]),_:2},[E.value?{name:"top-right",fn:a(()=>[l(r,{class:"button-section"},{default:a(()=>[l(b,{label:"Add User","no-caps":"",flat:"",class:"action-button",onClick:e[1]||(e[1]=o=>k.value=!0)})]),_:1})]),key:"0"}:void 0]),1032,["loading","rows","columns","filter"])])]),_:1})]),_:1}),l(j,{modelValue:N.value,"onUpdate:modelValue":e[2]||(e[2]=o=>N.value=o),persistent:""},{default:a(()=>[l(I,null,{default:a(()=>[l(r,null,{default:a(()=>[e[24]||(e[24]=t("div",{class:"text-h6 text-weight-medium q-py-md"},"Delete User",-1)),e[25]||(e[25]=t("div",{class:"text-subtitle1 q-pb-md"},"Are you sure you want to delete this user?",-1)),t("div",_e,[R(l(b,{flat:"",label:"Cancel",color:"primary"},null,512),[[Y]]),R(l(b,{flat:"",label:"Delete",style:{color:"red"},onClick:ee,loading:S.value},null,8,["loading"]),[[Y]])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:k.value,"onUpdate:modelValue":e[12]||(e[12]=o=>k.value=o),persistent:""},{default:a(()=>[l(I,{style:{width:"1000px","max-width":"1200px"}},{default:a(()=>[l(r,{style:{width:"100%"},class:"flex flex-center"},{default:a(()=>[t("div",ke,[l(O,{onSubmit:M(K,["prevent"])},{default:a(()=>[l(r,null,{default:a(()=>e[26]||(e[26]=[t("div",{class:"text-center text-h5 text-weight-medium"},"CREATE NEW ACCOUNT",-1)])),_:1}),l(r,null,{default:a(()=>[t("div",he,[t("div",Ue,[l(r,null,{default:a(()=>[e[27]||(e[27]=u(" First Name ")),t("div",qe,[l(n,{type:"text",modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=o=>i.value=o),borderless:""},null,8,["modelValue"])])]),_:1})]),t("div",Ne,[l(r,null,{default:a(()=>[e[28]||(e[28]=u(" Middle Name ")),t("div",Ce,[l(n,{type:"text",modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=o=>g.value=o),borderless:"",label:"optional"},null,8,["modelValue"])])]),_:1})]),t("div",Qe,[l(r,null,{default:a(()=>[e[29]||(e[29]=u(" Last Name ")),t("div",De,[l(n,{type:"text",modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=o=>f.value=o),borderless:""},null,8,["modelValue"])])]),_:1})])]),t("div",Se,[t("div",Ae,[l(r,null,{default:a(()=>[e[30]||(e[30]=u(" Username ")),t("div",Ee,[l(n,{type:"text",modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=o=>m.value=o),borderless:""},null,8,["modelValue"])])]),_:1})]),t("div",Te,[l(r,null,{default:a(()=>[e[31]||(e[31]=u(" Email ")),t("div",$e,[l(n,{type:"email",modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=o=>p.value=o),borderless:""},null,8,["modelValue"])])]),_:1})])]),t("div",Ie,[t("div",je,[l(r,null,{default:a(()=>[e[32]||(e[32]=u(" Password ")),t("div",Pe,[l(n,{type:"password",modelValue:x.value,"onUpdate:modelValue":e[8]||(e[8]=o=>x.value=o),borderless:""},null,8,["modelValue"])])]),_:1})]),t("div",Le,[l(r,null,{default:a(()=>[e[33]||(e[33]=u(" Confirm Password ")),t("div",ze,[l(n,{type:"password",modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=o=>V.value=o),borderless:""},null,8,["modelValue"])])]),_:1})])]),t("div",Be,[t("div",Fe,[l(r,null,{default:a(()=>[e[34]||(e[34]=u(" Role ")),t("div",Re,[l(D,{modelValue:v.value,"onUpdate:modelValue":e[10]||(e[10]=o=>v.value=o),options:T.value.option,borderless:""},null,8,["modelValue","options"])]),e[35]||(e[35]=u(" Year ")),t("div",Me,[l(D,{modelValue:y.value,"onUpdate:modelValue":e[11]||(e[11]=o=>y.value=o),options:L,borderless:""},null,8,["modelValue"])])]),_:1})])]),l(r,{class:"flex flex-center"},{default:a(()=>[t("div",null,[l(b,{label:"Done",type:"submit",flat:"",loading:w.value,style:{"background-color":"#132b10",color:"#ffffff"}},null,8,["loading"]),l(b,{class:"q-ml-sm",onClick:B,label:"cancel",flat:"",style:{color:"red"}})])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:h.value,"onUpdate:modelValue":e[20]||(e[20]=o=>h.value=o),persistent:""},{default:a(()=>[l(I,{style:{width:"1000px","max-width":"1200px"}},{default:a(()=>[l(r,{style:{width:"100%"},class:"flex flex-center"},{default:a(()=>[t("div",Oe,[l(O,{onSubmit:M(le,["prevent"])},{default:a(()=>[l(r,null,{default:a(()=>e[36]||(e[36]=[t("div",{class:"text-center text-h5 text-weight-medium"},"EDIT USER",-1)])),_:1}),l(r,null,{default:a(()=>[t("div",Ye,[t("div",We,[l(r,null,{default:a(()=>[e[37]||(e[37]=u(" First Name ")),t("div",Ge,[l(n,{type:"text",modelValue:i.value,"onUpdate:modelValue":e[13]||(e[13]=o=>i.value=o),borderless:""},null,8,["modelValue"])])]),_:1})]),t("div",He,[l(r,null,{default:a(()=>[e[38]||(e[38]=u(" Middle Name ")),t("div",Je,[l(n,{type:"text",modelValue:g.value,"onUpdate:modelValue":e[14]||(e[14]=o=>g.value=o),borderless:""},null,8,["modelValue"])])]),_:1})]),t("div",Ke,[l(r,null,{default:a(()=>[e[39]||(e[39]=u(" Last Name ")),t("div",Xe,[l(n,{type:"text",modelValue:f.value,"onUpdate:modelValue":e[15]||(e[15]=o=>f.value=o),borderless:""},null,8,["modelValue"])])]),_:1})])]),t("div",Ze,[t("div",el,[l(r,null,{default:a(()=>[e[40]||(e[40]=u(" Username ")),t("div",ll,[l(n,{type:"text",modelValue:m.value,"onUpdate:modelValue":e[16]||(e[16]=o=>m.value=o),borderless:""},null,8,["modelValue"])])]),_:1})]),t("div",tl,[l(r,null,{default:a(()=>[e[41]||(e[41]=u(" Email ")),t("div",ol,[l(n,{type:"email",modelValue:p.value,"onUpdate:modelValue":e[17]||(e[17]=o=>p.value=o),borderless:""},null,8,["modelValue"])])]),_:1})])]),t("div",al,[t("div",sl,[l(r,null,{default:a(()=>[e[42]||(e[42]=u(" Role ")),t("div",rl,[l(D,{modelValue:v.value,"onUpdate:modelValue":e[18]||(e[18]=o=>v.value=o),options:T.value,borderless:""},null,8,["modelValue","options"])]),e[43]||(e[43]=u(" Year ")),t("div",dl,[l(D,{modelValue:y.value,"onUpdate:modelValue":e[19]||(e[19]=o=>y.value=o),options:L,borderless:""},null,8,["modelValue"])])]),_:1})])]),l(r,{class:"flex flex-center"},{default:a(()=>[t("div",null,[l(b,{label:"Update",type:"submit",flat:"",loading:w.value,style:{"background-color":"#132b10",color:"#ffffff"}},null,8,["loading"]),l(b,{class:"q-ml-sm",onClick:B,label:"Cancel",flat:"",style:{color:"red"}})])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1}))}},Dl=be(ul,[["__scopeId","data-v-9aad8006"]]);export{Dl as default};
